<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel= "stylesheet" type="text/css" href="style.css">
    <title>Mortgage</title>
    
</head>
<body>
    <h1>Calculate Your Mortgage!</h1>
    <div class = inputForm>
        <form>
            <label for="apr">APR:</label>
            <input type="text" id="apr" name="apr"
             onchange="validate('apr', apr)"><p id = "aprerror"></p><br>
            <label for="term">Loan Term:</label>
            <input type="text" id="term" name="term"
             onchange="validate('term', term)"><p id = "termerror"></p><br>
            <label for="amount">Loan Amount:</label>
            <input type="text" id="amount" name="amount"
             onchange="validate('amount', amount)"><p id = "amounterror"></p><br>
            <input type="reset" value="clear" id = "clear" onclick="getfocus()">
            <button type = "button" onclick="calc()">Click me</button><p id = "buttonerror"></p><br><br>
            <label for="payment">Payment:</label>
            <output type="text" id="payment" name="payment">
          </form>
    </div><!--input-->

<script>
    //autofocus on apr when loaded
    window.onload = function() {
    document.getElementById("apr").focus();
    };
    let apr=0, term=0, amount=0, monthlyPayment, update=0, boolCalc = 0;
    function calc() {
        //check for all values being true and calc is available
        if (!boolCalc || !apr || !term || !amount){
            document.getElementById("buttonerror").innerHTML = "Please Enter Valid Inputs";
            return;
        }
        document.getElementById("buttonerror").innerHTML = "";
        update = 1;
        var r = (apr/100)/12;
        var n = term * 12;
        monthlyPayment = amount* r * (((1+r)**n)/(((1+r)**n)-1));
        console.log(monthlyPayment);
        document.getElementById("payment").value = monthlyPayment.toFixed(2);
    }

    /**id == apr term amount etc based on what you send*/
    function validate(field, id){  
        //get the values
        apr = document.getElementById("apr").value;
        //console.log(apr);
        term = document.getElementById("term").value;
        //console.log(term);
        amount = document.getElementById("amount").value;
        //console.log(amount);

        //set values to true
        document.getElementById(field + "error").innerHTML = ""; 
        boolCalc = true;


        //check value of variables based on the field that is passed
        if(isNaN(id.value) || (apr> 25) || term > 30){
            console.log(field);
            document.getElementById(field + "error").innerHTML = "Input not Valid"; //throw error
            boolCalc = 0;
            document.getElementById(field).focus(); // focus on the error
        }
        
        //if button has been clicked and all values are good call calc every time they update.
        if(update){calc()}
    }
    //set focus
    function getfocus() {
        document.getElementById("apr").focus();
        document.getElementById("aprerror").innerHTML = ""; 
        document.getElementById("termerror").innerHTML = "";
        document.getElementById("amounterror").innerHTML = "";
        document.getElementById("buttonerror").innerHTML = "";
    }
</script>

</body>
</html>